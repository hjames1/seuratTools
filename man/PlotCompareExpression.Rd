% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotCompareExpression.R
\name{PlotCompareExpression}
\alias{PlotCompareExpression}
\title{比较不同条件下各分组的基因表达并进行可视化}
\usage{
PlotCompareExpression(
  seurat_obj,
  feature,
  group.by,
  split.by,
  min.cells = 50,
  test.method = "wilcox.test",
  p.adjust.method = "BH",
  label.type = "signif",
  colors = c("blue", "red"),
  ...
)
}
\arguments{
\item{seurat_obj}{一个Seurat对象。}

\item{feature}{要绘制的特征（例如，一个基因名）。}

\item{group.by}{用于分面的主要分组变量（例如 "seurat_annotations", 细胞类型）。}

\item{split.by}{用于在每个分面内进行比较的分组变量（例如 "stim", 处理条件），此变量应只包含两个水平。}

\item{min.cells}{整数，一个分组中被保留的最小细胞数。少于此数目的分组将被过滤掉。默认为 50。}

\item{test.method}{统计检验方法，"wilcox.test" (默认) 或 "t.test"。}

\item{p.adjust.method}{p值校正方法。如果为NULL，则不进行校正。常用 "BH" (或 "fdr")。默认为 "BH"。}

\item{label.type}{标签显示类型。必须是 "signif" (显示显著性星号，默认) 或 "p.value" (显示数值)之一。}

\item{colors}{一个包含两种颜色的向量，用于指定 \code{split.by} 变量的颜色。默认为 c("blue", "red")。}

\item{...}{其他要传递给 \code{ggpubr::ggboxplot} 的参数。}
}
\value{
返回一个 ggplot 对象。
}
\description{
此函数用于可视化在两个不同条件下（如对照组 vs 刺激组），
多个细胞类型中某个基因的表达差异。它会自动过滤掉细胞数过少的组，
对每组进行Wilcoxon或t检验，对p值进行多重检验校正，并用分面箱线图展示结果。
}
